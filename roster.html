<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>FIGHTSHIFT — Roster</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="style.css">
  <link rel="icon" type="image/png" href="favicon.png">
  <style>
    .roster-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:16px;width:100%;max-width:1100px;margin:30px auto;}
    .card{padding:16px;border-radius:12px;background:rgba(0,0,0,0.4);border:2px solid rgba(0,255,255,0.12);box-shadow:0 0 10px rgba(0,255,255,0.06);transition:transform .2s,box-shadow .2s;cursor:pointer}
    .card:hover{transform:translateY(-6px) scale(1.02);box-shadow:0 0 24px rgba(0,255,255,0.2)}
    .name{font-size:14px;margin-bottom:8px}
    .ability-list{ text-align:left; margin-top:10px; font-size:12px;}
  </style>
</head>
<body>
  <div id="main-content">
    <h1>Roster — FIGHTSHIFT</h1>
    <div id="grid" class="roster-grid"></div>
    <nav><button onclick="location.href='index.html'">⬅️ Retour</button></nav>
  </div>

  <audio id="bg-music" loop>
    <source src="techno_syndrome.mp3" type="audio/mpeg">
  </audio>
  <script src="shared-audio.js"></script>
  <script>
    const music = document.getElementById('bg-music');
    window.sharedAudio.tryResume(music);

    const colorBadge = (c)=> {
      if(c==='red') return '<span class="badge color-red">ROUGE</span>';
      if(c==='blue') return '<span class="badge color-blue">BLEU</span>';
      return '<span class="badge color-green">VERT</span>';
    };
    async function loadRoster(){
      const res = await fetch('roster.json');
      const data = await res.json();
      const grid = document.getElementById('grid');
      data.forEach(ch => {
        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `
          <div class="name"><strong>${ch.name}</strong> ${colorBadge(ch.color)}</div>
          <div class="hp">PV : ${ch.hp_max}</div>
          <div class="short">${ch.short}</div>
          <div class="ability-list"><em>Compétences :</em><ul>${ch.abilities.map(a=>'<li>'+a+'</li>').join('')}</ul></div>
        `;
        card.addEventListener('click', ()=> showDetails(ch));
        grid.appendChild(card);
      });
    }
    function showDetails(ch){
      const w = window.open('', '_blank');
      const html = `<!doctype html>
      <html lang='fr'><head>
      <meta charset='utf-8'><title>${ch.name} — FIGHTSHIFT</title>
      <link rel='stylesheet' href='style.css'>
      <style>body{{padding:40px}} .details{{max-width:800px;margin:0 auto;background:rgba(0,0,0,0.45);padding:20px;border-radius:12px}}</style>
      </head><body>
      <div class='details'>
        <h1>${ch.name} ${colorBadge(ch.color)}</h1>
        <p><strong>PV :</strong> ${ch.hp_max}</p>
        <p>${ch.short}</p>
        <h3>Compétences</h3>
        <ul>${ch.abilities.map(a=>'<li>'+a+'</li>').join('')}</ul>
        <button onclick="window.close()">Fermer</button>
      </div>
      </body></html>`;
      w.document.write(html);
      w.document.close();
    }
    loadRoster();
  </script>
</body>
</html>
